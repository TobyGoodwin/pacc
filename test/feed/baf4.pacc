/*
type int
parse 5 5
parse 5 2+3
parse 6 '2 *' 3
parse 919512 '456 +' '123 *' '(' 543 + 7 '*' '(' 987 + 2 ')' + 6 ')'
noparse 1:1 Sum x
end '456 +'
*/

# Bryan Ford's trivial grammar with integers, spacing, repetitions, and
# character classes.

Sum :: int ← _ a:Additive __ End → a
Additive ← m:Multitive __ Plus __ a:Additive { m + a } / m:Multitive -> m
Multitive ← p:Primary __ Times __ m:Multitive { p * m } / p:Primary -> p
Primary ← Left __ a:Additive __ Right -> a / d:Decimal -> d
Decimal ← Digit+ _ { atoi(ref_ptr(ref())) }
Digit :: void ← [0-9]

Left ← "(" _
Right ← ")" _
Plus ← "+" _
Times ← "*" _
__ ← ("\n" _)*
_ ← [ \t] *
End ← !.
